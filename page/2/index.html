<!DOCTYPE html>
<html>
<head><meta name="generator" content="Hexo 3.9.0">
  <meta charset="utf-8">
  

  
  <title>LeoneZhu‘s Blog</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta property="og:type" content="website">
<meta property="og:title" content="LeoneZhu‘s Blog">
<meta property="og:url" content="https://leonezhu.github.io/blog/page/2/index.html">
<meta property="og:site_name" content="LeoneZhu‘s Blog">
<meta property="og:locale" content="en">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="LeoneZhu‘s Blog">
  
    <link rel="alternate" href="/blog/atom.xml" title="LeoneZhu‘s Blog" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link rel="stylesheet" href="/blog/css/style.css">
</head>
</html>
<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/blog/" id="logo">LeoneZhu‘s Blog</a>
      </h1>
      
        <h2 id="subtitle-wrap">
          <a href="/blog/" id="subtitle">记录美丽生活</a>
        </h2>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/blog/">Home</a>
        
          <a class="main-nav-link" href="/blog/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/blog/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="https://leonezhu.github.io/blog"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main">
  
    <article id="post-mysql/mysql" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/blog/2019/08/12/mysql/mysql/" class="article-date">
  <time datetime="2019-08-11T19:10:46.262Z" itemprop="datePublished">2019-08-12</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="Mysql"><a href="#Mysql" class="headerlink" title="Mysql"></a>Mysql</h1><ul>
<li><p>常用SQL语句</p>
</li>
<li><p>数据类型</p>
<p><a href="https://blog.csdn.net/DayDreamingBoy/article/details/6310907" target="_blank" rel="noopener">https://blog.csdn.net/DayDreamingBoy/article/details/6310907</a></p>
</li>
<li><p>存储引擎</p>
<ul>
<li>MyISAM：Mysql5.0之前的默认数据库引擎，较高的插入、查询速度，但不支持事务</li>
<li>InnoDB：Mysql5.5 版本后的默认数据库引擎。支持ACID事务，支持外键，支持行级锁</li>
<li>BDB：第三方Mysql存储引擎</li>
</ul>
</li>
<li><p>锁</p>
</li>
</ul>
<p><a href="https://zhuanlan.zhihu.com/p/29150809" target="_blank" rel="noopener">Mysql锁的总结</a></p>
<p>  并发事务同时访问一个资源时，有可能导致数据不一致。锁就是其中将数据访问顺序化，以保证数据库数据的一致性的机制。锁是在执行多线程时用于强行限制资源访问的同步机制，即用于在并发控制中保证对互斥要求的满足。</p>
<p>  锁的分类：</p>
<ul>
<li><p>按操作划分：</p>
<ul>
<li>DML锁：data locks，数据锁），用于保护数据的完整性，其中包括行级锁(Row Locks (TX锁))、表级锁(table lock(TM锁))</li>
<li>DDL锁：（dictionary locks，数据字典锁），用于保护数据库对象的结构，如表、索引等的结构定义。其中包排他DDL锁（Exclusive DDL lock）、共享DDL锁（Share DDL lock）、可中断解析锁（Breakable parse locks）</li>
</ul>
</li>
<li><p>按锁的粒度划分</p>
<ul>
<li>表级锁：开销小，加锁快；不会出现死锁；锁定粒度大，发生锁冲突的概率最高，并发度最低。</li>
<li>行级锁：开销大，加锁慢；会出现死锁；锁定粒度最小，发生锁冲突的概率最低，并发度也最高。</li>
<li>页级锁</li>
</ul>
</li>
<li><p>按锁的级别划分</p>
<ul>
<li>共享锁：读锁，其他事务可以读，不可以写</li>
<li>排他锁：写锁，其他事务既不能读也不能写</li>
</ul>
</li>
<li><p>按锁的加锁方式</p>
<ul>
<li>自动锁</li>
<li>显示锁</li>
</ul>
</li>
<li><p>按使用方式</p>
<ul>
<li>乐观锁：假设不会发生并发冲突，只在提交操作时检查是否违反数据完整性。乐观锁不不能解决脏读的问题。可以使用版本号等机制。乐观锁适用于多读的应用类型，这样可以提高吞吐量</li>
<li>悲观锁：每次去拿数据的时候都认为别人会修改，所以每次在拿数据的时候都会上锁，这样别人想拿这个数据就会block直到它拿到锁。传统的关系型数据库里边就用到了很多这种锁机制，比如行锁，表锁等，读锁，写锁等，都是在做操作之前先上锁。</li>
</ul>
<p>优化锁性能：</p>
<p>//TODO</p>
<p>死锁：死锁是指多个事务在同一个资源上相互占用，并请求锁定对方占用的资源，从而导致恶性循环</p>
<p>InnoDB避免死锁：</p>
<p>//TODO</p>
</li>
</ul>
<ul>
<li><p>索引</p>
<p><a href="https://tech.meituan.com/2014/06/30/mysql-index.html" target="_blank" rel="noopener">MySQL索引原理及慢查询优化</a></p>
<p>索引是一种数据结构，主要目的是加快查询速度。Mysql的默认存储引擎是InnoDB，InnoDB支持两种索引类别：B+Tree（平衡树），Hash索引。Hash索引适合等值查询，不适合范围查询，也不能利用索引排序，也不支持联合索引的最左匹配规则。B+Tree叶子节点上可以存放整行数据（聚集索引），也可以存放主键的值（非聚集索引）。因为聚集索引叶子节点上的值就是需要的数据所以查询速度快，非聚集索引需要根据叶子节点上的主键再进行查询（回表查询）。非聚集索引不一定需要查询多次，通过覆盖索引可以只查询一次。索引覆盖指一个查询语句的执行只用从索引中就能够取得，不必从数据表中读取，也可以称之为实现了索引覆盖。</p>
<ul>
<li>类型<ul>
<li>唯一索引：索引列中的值时唯一的，但可以出现空值</li>
<li>主键索引：特殊的唯一索引，不允许出现空值</li>
<li>普通索引：允许出现重复的值</li>
<li>联合索引：多个列按顺序组合共同的索引（左前缀匹配）</li>
<li>全文索引：只能在char、varchar、text上使用</li>
</ul>
</li>
<li>实现<ul>
<li>B-Tree：适合用于大于或等于的范围查询</li>
<li>R-Tree</li>
<li>Hash：使用散列表来对数据进行索引，</li>
<li>FullText</li>
</ul>
</li>
</ul>
<p>最左前缀匹配：如果有一个3列索引(col1,col2,col3)，则已经对(col1)、(col1,col2)、(col1,col3)和(col1,col2,col3)上建立了索引；这就是最左前缀原则</p>
</li>
<li><p>存储过程与函数</p>
</li>
<li><p>Mysql调优</p>
<p><img src="https://tva1.sinaimg.cn/large/006y8mN6gy1g7rrtqcfsgj30sm0ai0ui.jpg" alt="1565543527214"></p>
</li>
<li><p>新特性</p>
</li>
<li><p>SQL优化</p>
<ul>
<li>查看慢日志</li>
<li>explain查看执行计划</li>
<li>优化SQL语句</li>
</ul>
</li>
<li><p>读现象</p>
</li>
</ul>
<ul>
<li>脏读：一个事务正在访问数据，并且对数据进行了修改，而这种修改还没有提交(commit)到数据库中，这时，另外一个事务也访问这个数据，然后使用了这个数据。因为这个数据是还没有提交的数据，那么另外一个事务读到的这个数据是脏数据，依据脏数据所做的操作可能是不正确的。</li>
<li>不可重复读：一个事务范围内两个相同的查询却返回了不同数据。这是由于查询时系统中其他事务修改的提交而引起的。比如事务T1读取某一数据，事务T2读取并修改了该数据，T1为了对读取值进行检验而再次读取该数据，便得到了不同的结果。</li>
<li>幻读：第一个事务对一个表中的数据进行了修改，比如这种修改涉及到表中的“全部数据行”。同时，第二个事务也修改这个表中的数据，这种修改是向表中插入“一行新数据”。那么，以后就会发生操作第一个事务的用户发现表中还有没有修改的数据行，就好象发生了幻觉一样</li>
</ul>
<ul>
<li><p>事务</p>
<p>MySQL 事务主要用于处理操作量大，复杂度高的数据</p>
<ul>
<li>在 MySQL 中只有使用了 Innodb 数据库引擎的数据库或表才支持事务。</li>
<li>事务处理可以用来维护数据库的完整性，保证成批的 SQL 语句要么全部执行，要么全部不执行。</li>
<li>事务用来管理 insert,update,delete 语句</li>
</ul>
<p>ACID：满足事务的四个条件</p>
<ul>
<li><p>原子性（Atomicity）</p>
<p>又称不可分割性，一个事务（transaction）中的所有操作，要么全部完成，要么全部不完成，不会结束在中间某个环节。事务在执行过程中发生错误，会被回滚（Rollback）到事务开始前的状态，就像这个事务从来没有执行过一样</p>
</li>
<li><p>一致性（Consistency）</p>
<p>在事务开始之前和事务结束以后，数据库的完整性没有被破坏。这表示写入的资料必须完全符合所有的预设规则，这包含资料的精确度、串联性以及后续数据库可以自发性地完成预定的工作</p>
</li>
<li><p>隔离性（Isolation）</p>
<p>数据库允许多个并发事务同时对其数据进行读写和修改的能力，隔离性可以防止多个事务并发执行时由于交叉执行而导致数据的不一致。事务隔离分为不同级别，包括读未提交（Read uncommitted）、读提交（read committed）、可重复读（repeatable read）和串行化（Serializable）</p>
</li>
<li><p>持久性（Durability）</p>
<p>事务处理结束后，对数据的修改就是永久的，即便系统故障也不会丢失。</p>
</li>
</ul>
<p>事务的隔离级别</p>
</li>
</ul>
<ul>
<li>未提交读</li>
<li>提交读（读已提交）：Mysql默认事务隔离级别</li>
<li>可重复读</li>
<li>可序列化</li>
</ul>
<p>参考资料：</p>
<p><a href="https://www.runoob.com/mysql/mysql-transaction.html" target="_blank" rel="noopener">https://www.runoob.com/mysql/mysql-transaction.html</a></p>
<p><a href="https://www.w3cschool.cn/mysql/" target="_blank" rel="noopener">https://www.w3cschool.cn/mysql/</a></p>
<p><a href="https://kaiwu.lagou.com/course/courseInfo.htm?courseId=1" target="_blank" rel="noopener">https://kaiwu.lagou.com/course/courseInfo.htm?courseId=1</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://leonezhu.github.io/blog/2019/08/12/mysql/mysql/" data-id="ck2k66wa60008sncnn8me09e5" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  


  <nav id="page-nav">
    
    <a class="extend prev" rel="prev" href="/blog/">&laquo; Prev</a><a class="page-number" href="/blog/">1</a><span class="page-number current">2</span>
  </nav>

</section>
        
          <aside id="sidebar">
  
    

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/blog/tags/算法/">算法</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/blog/tags/算法/" style="font-size: 10px;">算法</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/blog/archives/2019/11/">November 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/blog/archives/2019/10/">October 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/blog/archives/2019/08/">August 2019</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/blog/2019/11/04/hexo操作/">(no title)</a>
          </li>
        
          <li>
            <a href="/blog/2019/10/10/数据结构与算法/数组/">(no title)</a>
          </li>
        
          <li>
            <a href="/blog/2019/10/09/数据结构与算法/时间、空间复杂度/">(no title)</a>
          </li>
        
          <li>
            <a href="/blog/2019/10/09/数据结构与算法/数据结构与算法之美/">数据结构与算法之美</a>
          </li>
        
          <li>
            <a href="/blog/2019/10/09/Shell-POST/">Shell &amp; POST</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2019 leonezhu<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/blog/" class="mobile-nav-link">Home</a>
  
    <a href="/blog/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/blog/fancybox/jquery.fancybox.css">
  <script src="/blog/fancybox/jquery.fancybox.pack.js"></script>


<script src="/blog/js/script.js"></script>



  </div>
</body>
</html>